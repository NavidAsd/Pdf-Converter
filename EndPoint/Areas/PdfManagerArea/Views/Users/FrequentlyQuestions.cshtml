@model Common.ResultMessage<Application.Services.Query.ViewContext.ReturnFrequentlyQuestion.ResultReturnFrequentlyQuestionDto>
@addTagHelper *, LazZiya.TagHelpers
@{
    Layout = "~/Areas/PdfManagerArea/Views/Shared/_Adminlayout.cshtml";
}


<head>
    <link href="~/Areas/Admin/css/NoResult.css" rel="stylesheet" />
    <link rel="shortcut icon" type="image/png" href="~/images/logo/66-modified.png">
    <title> PdfConverter | Admin-FrequentlyQuestions </title>
</head>


<style>
    body {
        align-items: center;
        background-color: var(--blue);
        background: url("/Areas/Admin/images/New_A.jpg");
        background-attachment: fixed;
        background-position: center;
        background-repeat: no-repeat;
        background-size: cover;
        display: grid;
        height: 100vh;
        place-items: center;
    }
</style>

<form method="get" class="form-inline">
    <input name="filter" class="form-control" placeholder="filter"
           value="@Model.Enything.Filter" />
    <button type="submit" class="btn btn-info">
        <span class="glyphicon glyphicon-search" aria-hidden="true"></span> Search
    </button>
</form>

<div class="  text-center">
    <paging total-records="@Model.Enything.TotalRow"
            page-no="@Model.Enything.PageIndex"
            page-size="@Model.Enything.Pagesize"
            show-prev-next="true"
            show-total-pages="false"
            show-total-records="false"
            show-page-size-nav="false"
            show-first-numbered-page="true"
            show-last-numbered-page="true"
            query-string-key-page-no="PageIndex"
            query-string-key-page-size="Size"
            query-string-value="@@(Request.QueryString.Value)"
            gap-size="2">
    </paging>

</div>


<div class="content-wrapper">
    <div class="container-fluid">
        <!-- Zero configuration table -->
        <section id="configuration">

            <div class="row">
                <div class="col-12">
                    <div class="card">
                        <a class="btn btn-success col-md-12" href="/PdfManagerArea/Users/Create?Service=@ViewBag.Service"> Create New </a>
                        <div class="card-title-wrap bar-success text-center"  >                     
                        <button type="submit" class="btn btn-light-blue" onclick="window.location.replace('/PdfManagerArea/Services/DownloadSchema/?Service=@ViewBag.Service&&Type=@Common.Schema.SchemaType.Faq')">
        <span class="glyphicon glyphicon-search" aria-hidden="true" ></span> Download Faq Schema
    </button>
    |
                            <button type="submit" class="btn btn-light-blue" onclick="window.location.replace('/PdfManagerArea/Services/DownloadSchema/?Service=@ViewBag.Service&&Type=@Common.Schema.SchemaType.HowTo')">
        <span class="glyphicon glyphicon-search" aria-hidden="true" ></span> Download HowTo Schema
    </button>

    </div>
                        <p>
                            <br />
                            <br />
                        </p>
                        <table class="table table-striped">
                            <thead>
                                <tr>
                                    <th></th>

                                    <th>
                                        Question
                                    </th>
                                    <th>
                                        Answer
                                    </th>
                                    <th></th>
                                    <th></th>

                                </tr>
                            </thead>

                            <tbody>
                                @foreach (var item in Model.Enything.Questions)
                                {
                                        <tr>
                                            <td></td>
                                            <td>
                                            @Html.Raw(item.Question)
                                            </td>
                                        @if (item.Answer != null)
                                        {
                                                    <td style="cursor:pointer" title="More" onclick="ShowModal('@Html.Raw(item.Answer);')">
                                                @if (item.Answer.Length > 30)
                                                {
                                                    @Html.Raw(item.Answer.Substring(0, 30).ToString() + "...")
                                                    ;
                                                }
                                                else
                                                {
                                                    @Html.Raw(item.Answer)
                                                    ;
                                                }
                                                    </td>
                                        }
                                        else
                                        {
                                                    <td>@Html.Raw(item.Answer);</td>
                                        }
                                            <td><a class="btn btn-info" href="/PdfManagerArea/Users/EditFrequentlyQuestion?Id=@item.Id">Edit</a></td>
                                        @if (item.IsRemoved == true)
                                        {
                                                    <td><a class="btn btn-outline-primary" onclick="SendData('@item.Id',false)">Restore</a></td>
                                        }
                                        else
                                        {
                                                    <td><a class="btn btn-danger" onclick="SendData('@item.Id',true)">Remove</a></td>
                                        }
                                        </tr>
                                }
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </section>
    </div>
</div>

<div class="  text-center">
    <paging total-records="@Model.Enything.TotalRow"
            page-no="@Model.Enything.PageIndex"
            page-size="@Model.Enything.Pagesize"
            show-prev-next="true"
            show-total-pages="false"
            show-total-records="false"
            show-page-size-nav="false"
            show-first-numbered-page="true"
            show-last-numbered-page="true"
            query-string-key-page-no="PageIndex"
            query-string-key-page-size="Size"
            query-string-value="@@(Request.QueryString.Value)"
            gap-size="2">
    </paging>

</div>
<link href="~/Sweetalert2/sweetalert2.min.css" rel="stylesheet" />
<script src="~/Sweetalert2/sweetalert2.min.js"></script>


<script>

    function SendData(Id, State) {
        var Data = new FormData();
        Data.append("Id", Id);
        Data.append("State", State);

        $.ajax({
            type: "POST",
            url: "/PdfManagerArea/Users/ChangeQuestionState/",
            contentType: false,
            processData: false,
            data: Data,
            success: function (data) {
                if (data.success == true) {
                    location.reload();
                }
                else {
                    swal.fire(
                        'Warning',
                        data.message,
                        'warning'
                    );
                }
            },
            error: function (xhr, ajaxOptions, thrownError) {
                alert(xhr.status);
                alert(thrownError);
            }
        });

    }

    function DownloadSchemaFile(Service){
        var data = {'Service':Service};
                $.ajax({
            type: "POST",
            url: "/PdfManagerArea/Services/DownloadSchema/",
            contentType: false,
            processData: false,
            data: data,
            success: function (data) {
                if (data.success == true) {
                    location.reload();
                }
                else {
                    swal.fire(
                        'Warning',
                        data.message,
                        'warning'
                    );
                }
            },
            error: function (xhr, ajaxOptions, thrownError) {
                alert(xhr.status);
                alert(thrownError);
            }
        });

    }

    function ShowModal(Message) {
        document.getElementById("areaMessage").value = Message;
        $("#mdlMessage").modal('show');
    }

</script>


@section Modals
    {
        <!-- Modal Message -->
        <div class="modal fade" id="mdlMessage" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
            <div class="modal-dialog modal-dialog-centered" role="document">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="exampleModalLongTitle">Message</h5>
                    </div>
                    <div class="modal-body">
                        <div class="col-xl-12 col-lg-12 col-md-12 mb-1">
                            <form>
                                <fieldset class="form-group">
                                    <textarea id="areaMessage" class="form-control " rows="5" readonly> None </textarea>
                                </fieldset>
                            </form>
                        </div>
                    </div>
                    <div class="modal-footer">
                    </div>
                </div>
            </div>
        </div>

        <!-- Modal Faq Schema -->
        <div class="modal fade" id="mdlSchema" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
            <div class="modal-dialog modal-dialog-centered" role="document">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="exampleModalLongTitle">Message</h5>
                    </div>
                    <div class="modal-body">
                        <div class="col-xl-12 col-lg-12 col-md-12 mb-1">
                            <form>
                                <fieldset class="form-group">
                                    <textarea id="areaMessage" class="form-control " rows="5" readonly> None </textarea>
                                </fieldset>
                            </form>
                        </div>
                    </div>
                    <div class="modal-footer">
                    </div>
                </div>
            </div>
        </div>
}
